{"version":3,"sources":["webpack:///./src/pages/charts/mysql-streaming/index.js"],"names":["xDesc","title","prop","values","yDesc","Environments","props","items","label","value","default","render","onChange","this","React","Component","getTicks","inc","max","result","i","push","MysqlStreamingImpl","state","extractor","environment","limitsBelow100Options","legend","position","focusTarget","hAxis","ticks","vAxis","format","viewWindow","min","limitsBelow1kOptions","JSON","parse","stringify","jmhList","href","setState","id","chartType","dataTable","filter","d","limit","options","flatten","listOfLists","forEach","l","v","MysqlStreaming","JmhChartPage","fetchFunc","Promise","all","loadJson","then","flattenAndSetEnvironment","index","list","data","params","exportDimensionsFunc","benchmark","split","driverPart","method","other","length","Error","substring","lastIndexOf","parseInt","headerText"],"mappings":"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","file":"component---src-pages-charts-mysql-streaming-index-js-3044a21f7f4991471fa0.js","sourcesContent":["import React from 'react';\nimport {ChartAndTable, Choose, JmhChartPage, TimeUnits} from '../../../components';\nimport {loadJson} from '../../../util';\n\nconst xDesc = {\n  title: 'Method',\n  prop: 'method',\n  values: [\n    'ConnectorJ.atOnce',\n    'ConnectorJ.stream',\n    'MariaDb.atOnce',\n    'MariaDb.stream',\n  ],\n};\n\nconst yDesc = {\n  title: 'limit',\n  prop: 'limit',\n  values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],\n};\n\nclass Environments extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.items = [\n      {\n        label: 'local',\n        value: 'local',\n      },\n      {\n        label: 'bad network (Wi-Fi)',\n        value: 'wifi',\n      },\n      {\n        label: 'good network (Wire)',\n        value: 'wire',\n        default: true,\n      },\n      {\n        label: 'strange',\n        value: 'strange',\n      },\n    ];\n  }\n\n  render() {\n    const {onChange} = this.props;\n    return (\n      <Choose label=\"Environment: \" onChange={onChange} items={this.items}/>\n    );\n  }\n}\n\nfunction getTicks(inc, max) {\n  const result = [];\n  for (let i = 0; i <= max; i += inc) {\n    result.push(i);\n  }\n  return result;\n}\n\nclass MysqlStreamingImpl extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      extractor: null,\n      environment: 'wire',\n    };\n\n    this.limitsBelow100Options = {\n      legend: {\n        // doesn't work with materialized UI\n        position: 'bottom',\n      },\n      // doesn't work with materialized UI\n      focusTarget: 'category',\n      hAxis: {\n        title: 'row count',\n        ticks: getTicks(10, 100),\n      },\n      vAxis: {\n        title: 'time, microseconds',\n        format: 'short',\n        viewWindow: {\n          min: 0,\n        },\n      },\n    };\n    this.limitsBelow1kOptions = JSON.parse(JSON.stringify(this.limitsBelow100Options));\n    this.limitsBelow1kOptions.hAxis.ticks = getTicks(100, 1000);\n  }\n\n  render() {\n    const {extractor, environment} = this.state;\n    const {jmhList} = this.props;\n\n    return (\n      <div>\n        <h3>Introduction</h3>\n\n        <p>\n          The performance tests are performed via <a href=\"http://openjdk.java.net/projects/code-tools/jmh/\">JMH</a>.\n          The configuration of a hardware is Intel® Core™ i7–5600U CPU @ 2.60GHz × 4 (2 core + 2 HT) with 16 GB RAM.\n        </p>\n\n        <h3>Charts</h3>\n\n        <Environments onChange={environment => this.setState({environment})}/>\n        <TimeUnits onChange={extractor => this.setState({extractor})}/>\n\n        <h3 id=\"below-100\">LIMIT below 100</h3>\n\n        <ChartAndTable\n          chartType=\"LineChart\"\n          dataTable={jmhList}\n          extractor={extractor}\n          filter={d => d.environment === environment && d.limit <= 100}\n          title=\"LIMIT below 100, microseconds\"\n          xDesc={xDesc}\n          yDesc={yDesc}\n          options={this.limitsBelow100Options}\n        />\n\n        <h3 id=\"all-drivers\">All LIMITs</h3>\n\n        <ChartAndTable\n          chartType=\"LineChart\"\n          dataTable={jmhList}\n          extractor={extractor}\n          filter={d => d.environment === environment && d.limit <= 1000}\n          title=\"All LIMITs, microseconds\"\n          xDesc={xDesc}\n          yDesc={yDesc}\n          options={this.limitsBelow1kOptions}\n        />\n      </div>\n    );\n  }\n}\n\nfunction exportDimensions(benchmark, params) {\n  //'com.komanov.mysql.streaming.jmh.ConnectorJBenchmark.atOnce'\n\n  const [driverPart, method, ...other] = benchmark.split('Benchmark.');\n  if (!driverPart || !method || other.length > 0) {\n    throw new Error('Expected 2 parts in a benchmark: ' + benchmark);\n  }\n\n  const {limit, environment} = params;\n\n  return {\n    method: driverPart.substring(driverPart.lastIndexOf('.') + 1) + '.' + method,\n    limit: parseInt(limit, 10),\n    environment,\n  };\n}\n\nfunction fetchAndCombineResults() {\n  return Promise.all([\n    loadJson('/data/charts/mysql-streaming/jmh-results-local.json'),\n    loadJson('/data/charts/mysql-streaming/jmh-results-wifi.json'),\n    loadJson('/data/charts/mysql-streaming/jmh-results-wire.json'),\n    loadJson('/data/charts/mysql-streaming/jmh-results-strange.json'),\n  ]).then(values => {\n    function flattenAndSetEnvironment(index, environment) {\n      const list = flatten(values[index].data);\n      list.forEach(v => v.params.environment = environment);\n      return list;\n    }\n\n    return {\n      data: flatten([\n        flattenAndSetEnvironment(0, 'local'),\n        flattenAndSetEnvironment(1, 'wifi'),\n        flattenAndSetEnvironment(2, 'wire'),\n        flattenAndSetEnvironment(3, 'strange'),\n      ]),\n    };\n  });\n}\n\nfunction flatten(listOfLists) {\n  const result = [];\n  listOfLists.forEach(l => l.forEach(v => result.push(v)));\n  return result;\n}\n\nconst MysqlStreaming = JmhChartPage(\n  MysqlStreamingImpl,\n  {\n    fetchFunc: fetchAndCombineResults,\n    exportDimensionsFunc: exportDimensions,\n    headerText: 'The Cost of a Streaming Data from MySQL (Charts)',\n  },\n);\n\nexport default MysqlStreaming;\n"],"sourceRoot":""}